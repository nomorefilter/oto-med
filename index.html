<!doctype html>
<html id="id">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="description" contact="おとわっかなどの作品により大ヒットしたおとめっどのロゴジェネレーター。">
        <title>おとめっどロゴジェネレーター</title>
        <link rel="stylesheet" href="css/sanitize.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="css/style.css">
        <link rel="icon" href="favicon.ico">
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-172770628-8"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date())
            gtag('config', 'UA-172770628-8');
        </script>
    </head>
    <body onload="drawText('preview', 'canvas_text', 'canvas_text2');" id="www">
        <canvas id="preview"></canvas>
        <p>
        <input type="text" id="canvas_text" value="おとめっど">
        <input type="text" id="canvas_text2" value="oto-med">
        <input type="range" id="range" min="90" max="130" value="109">
        <button id="generator_button" onclick="drawText('preview', 'canvas_text', 'canvas_text2');" class="btn btn-primary">生成</button>
        <button id="download_button" class="btn btn-secondary">ダウンロード</button>
        </p>
        <p><b>↓高度な加工がしたい方↓</b><br>AviUtlを使用してより高度な加工ができます。<br>下のファイルをダウンロードして使ってください。<br>詳しくはファイルの中のreadme.txtを参照。<br><a href="data/oto-med.zip" download="oto-med.zip">zipファイルダウンロード</a></p>
        <p>お問い合わせは<a href="https://twitter.com/intent/user?user_id=1440832091378257924" style="cursor: url(&quot;chrome-extension://ledmjlnkdlappilhaaihfhanlpdjjalm/rockhand.png&quot;), auto;">@SASSAS68982216</a>まで</p>
        <a id="download_link"></a>
        </div>
        <script class="alpha">
            const cvs = document.getElementById('preview');
            cvs.setAttribute("width" , 1000);
            cvs.setAttribute("height" , 1000);
        function drawText(canvas_id, text_id, text_id2)
        {
            var canvas = document.getElementById(canvas_id);
            var ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, 10000, 10000);
            let text = document.getElementById(text_id);
            let text2 = document.getElementById(text_id2);
            let text_in2 = text2.value;
            let text_in = text.value;
            let moji = [...text_in];
            let range = document.getElementById('range');
            let range2 = range.value
            console.log(range2);
            console.log(moji);
            oto2(0, '#000000', 410, 50, 135, 515, -10);
            oto2(1, '#000000', 365, 50, 530, 425, 10);
            oto2(2, '#000000', 360, 50, -115, 890, -20);
            oto2(3, '#000000', 270, 50, 430, 835, 20);
            oto2(4, '#000000', 380, 50, 710, 695, 10);
            ctx.rotate(-10 * Math.PI / 180);
            ctx.beginPath();
            ctx.ellipse(500, 505, 293, 265, 0, 0, Math.PI * 2, true);
            ctx.fillStyle = "#ffffff";
            ctx.fill();
            ctx.strokeStyle = "#000000" ;
            ctx.lineWidth = 10 ;
            ctx.stroke();
            oto2(0, '#ffffff', 410, 30, 135, 515, -10);
            oto2(1, '#ffffff', 365, 30, 530, 425, 10);
            oto2(2, '#ffffff', 360, 30, -115, 890, -20);
            oto2(3, '#ffffff', 270, 30, 430, 835, 20);
            oto2(4, '#ffffff', 380, 30, 710, 695, 10);
            ctx.rotate(-10 * Math.PI / 180);
            ctx.font = 'bold '+ range2 +'px sono2';
            ctx.fillStyle = '#f39500';
            ctx.fillText(text_in2, 218, 540);
            oto(0, '#e73161', 410, 135, 515, -10);
            oto(1, '#00addc', 365, 530, 425, 10);
            oto(2, '#a561a4', 360, -115, 890, -20);
            oto(3, '#71ba2d', 270, 430, 835, 20);
            oto(4, '#ff65ac', 380, 710, 695, 10);
            ctx.rotate(-10 * Math.PI / 180);
        }
        function oto(nom, color, size, xx, yy, zz){
            var canvas = document.getElementById('preview');
            var ctx = canvas.getContext('2d');
            let text = document.getElementById('canvas_text');
            let text2 = text.value;
            let moji = [...text2];
            ctx.beginPath();
            ctx.font = ''+ size +'px sono1';
            console.log(size);
            ctx.fillStyle = color;
            ctx.rotate(zz * Math.PI / 180);
            ctx.fillText(moji[nom], xx, yy);
        }
        function oto2(nom, color, size, size2, xx, yy, zz){
            var canvas = document.getElementById('preview');
            var ctx = canvas.getContext('2d');
            let text = document.getElementById('canvas_text');
            let text2 = text.value;
            let moji = [...text2];
            ctx.beginPath();
            ctx.font = ''+ size +'px sono1';
            console.log(size);
            ctx.lineWidth = size2;
            ctx.strokeStyle = color;
            ctx.rotate(zz * Math.PI / 180);
            ctx.strokeText(moji[nom], xx, yy);
        }
        document.getElementById("download_button").onclick = (event) => {
            let canvas = document.getElementById("preview");
            let text = document.getElementById("canvas_text");
            let text_in = text.value;
            var filename = ''+ text_in +'.png';
            let link = document.createElement("a");
            link.href = canvas.toDataURL("image/png");
            link.download = filename;
            link.click();
        }
        // 二回動かさないとなんかフォントがバグるんよね
        drawText('preview', 'canvas_text', 'canvas_text2');
        </script>
        </body>
</html>
